<body class="fix-header fix-sidebar card-no-border" onload="SetDate()">

    @{
        Html.RenderPartial("Header");
    }


    @{
        Html.RenderPartial("Side_Navigation");
    }

    <div class="page-wrapper">

        <div class="row page-titles">
            <div class="col-md-5 align-self-center">
                <h3 class="text-themecolor">New Brother Invoice</h3>
            </div>
            <div class="col-md-7 align-self-center">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="~/Admin/Index">Home</a></li>
                    <li class="breadcrumb-item">Main Menu</li>
                    <li class="breadcrumb-item custom_lime_green active">Add New Invoice</li>
                </ol>
            </div>

        </div>

        <div class="container-fluid">
            <div class="row">
                <div class="col-lg-12">
                    <div class="card card-outline-info">

                        <div class="card-body">
                            <form method="post" action="@Url.Action("Create_Invoice", "Brother")" data-parsley-validate class="" enctype="multipart/form-data">
                                <div class="form-body">
                                    <div class="row">
                                        <div class="col-md-7"></div>
                                        <div class="col-md-5">
                                            <ul class="navbar-nav">
                                                <li class="font-medium pull-right">Invoice No. <span class="pull-right"><input class="invoice_top_input text-center" type="text" value="@ViewBag.invoice_number" /></span></li>
                                                <li class="font-medium p-t-5"><span>Date </span><span class="pull-right"><input id="invoice_date_create" name="invoice_date" class="invoice_top_input text-center" type="text" style="width:166px!important;" required /></span></li>
                                                @*<li class="font-medium p-t-5"><span>Sales Person </span><span class="pull-right"><input class="invoice_top_input" type="text" value="@Session["admin_name"]" readonly /></span></li>*@

                                            </ul>
                                        </div>
                                    </div>
                                    <script>

                                    </script>
                                    <div class="row p-t-20">
                                        <div class="col-md-3">
                                            <div class="form-group">
                                                <label class="control-label">Sold To</label>
                                                <input type="text" name="sold_to" id="sold_to" class="form-control" placeholder="Name" onkeypress="validation_alphabetical(event)" required>
                                            </div>
                                        </div>

                                        <div class="col-md-3">
                                            <div class="form-group ">
                                                <label class="control-label">Address</label>
                                                <input type="text" name="sold_address_house" id="sold_address_house" class="form-control" placeholder="Address" required>
                                            </div>
                                        </div>


                                        <div class="col-md-3">
                                            <div class="form-group">
                                                <label class="control-label">City</label>
                                                <input type="text" class="form-control" name="sold_area_address" id="area_address_house" placeholder="Town, City" required>
                                            </div>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="form-group">
                                                <label class="control-label">Email</label>
                                                <input type="email" class="form-control" name="sold_email" id="sold_email" placeholder="Email" required>
                                            </div>
                                        </div>



                                    </div>

                                    <div class="row p-t-10">
                                        <div class="col-md-3">
                                            <div class="form-group">
                                                <label class="control-label">Ship To</label>
                                                <input type="text" name="ship_to" id="ship_to" class="form-control" placeholder="Name" onkeypress="validation_alphabetical(event)" required>
                                            </div>
                                        </div>

                                        <div class="col-md-3">
                                            <div class="form-group ">
                                                <label class="control-label">Address</label>
                                                <input type="text" name="ship_address_house" id="ship_address_house" class="form-control" placeholder="Address" required>
                                            </div>
                                        </div>


                                        <div class="col-md-3">
                                            <div class="form-group">
                                                <label class="control-label">City</label>
                                                <input type="text" class="form-control" name="ship_area_address" id="ship_area_address" placeholder="Town, City" required>
                                            </div>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="form-group">
                                                <label class="control-label">Email</label>
                                                <input type="email" class="form-control" name="ship_email" id="ship_email" placeholder="Email" required>
                                            </div>
                                        </div>



                                    </div>


                                    <div class="row p-t-10">


                                        <div class="col-md-3">
                                            <div class="form-group ">
                                                <label class="control-label">Person Name </label>
                                                <input type="text" name="ship_person_name" id="ship_person_name" class="form-control" placeholder="Name" required>
                                            </div>
                                        </div>


                                        <div class="col-md-3">
                                            <div class="form-group">
                                                <label class="control-label">Phone</label>
                                                <input type="text" name="ship_phone" id="ship_phone" class="form-control" placeholder="Phone" onkeypress="validation_phone(event)" required>
                                            </div>
                                        </div>



                                    </div>

                                    <hr>

                                    <div class="row p-t-10">
                                        <div class="table-responsive p-t-10">
                                            <table id="myTable" class="table firstrow">
                                                <thead>
                                                    <tr class="bg-dark">
                                                        <th class="text-center border_right_td">SHIP VIA</th>
                                                        <th class="text-center border_right_td">F.O.B</th>
                                                        <th class="text-center border_right_td">EST. Ship DATE</th>
                                                        <th class="text-center border_right_td">SLM</th>
                                                        <th class="text-center">CUST.P.O.#</th>

                                                    </tr>
                                                </thead>
                                                <tbody>

                                                    <tr>
                                                        <td class="text-center border_right_td"><input class="static_width_td" type="text" placeholder="Ship Via" name="ship_via" required/></td>
                                                        <td class="text-center border_right_td"><input class="static_width_td" type="text" placeholder="F.O.B" name="fob" required/></td>
                                                        <td class="text-center border_right_td"><input class="static_width_td" type="text" placeholder="EST. Ship Date" name="est_ship_date" id="est_ship_date" required/></td>
                                                        <td class="text-center border_right_td"><input class="static_width_td" type="text" placeholder="SLM" name="slm" required/></td>
                                                        <td class="text-center border_right_td"><input class="static_width_td" type="text" placeholder="CUST.P.O.#" name="cust_po" required/></td>


                                                    </tr>



                                                </tbody>
                                            </table>


                                        </div>
                                    </div>



                                    <hr>



                                    <div class="row p-t-10">

                                        <div class="table-responsive p-t-10">
                                            <table class="table firstrow">
                                                <thead>
                                                    <tr class="">
                                                        <th class="bg-dark text-center">Terms</th>
                                                        <th class="text-center border_right_td"><input class="static_width_td" type="text" placeholder="Terms" name="terms" required/></th>
                                                        <th class="bg-dark text-center">F &amp; C</th>
                                                        <th class="text-center"><input class="static_width_td" type="text" placeholder="F&C" name="f_c" required/></th>

                                                    </tr>
                                                </thead>

                                            </table>


                                        </div>

                                    </div>


                                    <div class="row p-t-10">
                                        <div class="table-responsive p-t-10">
                                            <table id="myTable" class="table firstrow">
                                                <thead>
                                                    <tr class="bg-dark">
                                                        <th class="text-center border_right_td">Item/Description</th>
                                                        <th width="5%" class="text-center border_right_td">Quantity</th>
                                                        <th class="text-center border_right_td">Footage</th>
                                                        <th class="text-center border_right_td">Price</th>
                                                        <th class="text-center">Amount</th>
                                                        <th class="text-center">Actions</th>

                                                    </tr>
                                                </thead>
                                                <tbody>

                                                    <tr>
                                                        <td class="text-center border_right_td"><textarea class="static_width_td" placeholder="Description" name="description" id="description1" required></textarea></td>
                                                        <td width="12%" class="text-center border_right_td"><input class="static_width_td" type="text" placeholder="0.00" name="quantity" id="quantity1" onkeypress="validation_numeric(event)" required/></td>
                                                        <td width="12%" class="text-center border_right_td"><input class="static_width_td" type="text" placeholder="0.00" name="footage" id="footage1" onkeyup="Total(1)" onkeypress="validation_numeric(event)" required/></td>
                                                        <td width="12%" class="text-center border_right_td"><input class="static_width_td" type="text" placeholder="0.00" name="price" id="price1" onkeyup="Total(1)" onkeypress="validation_numeric(event)" required/></td>
                                                        <td width="12%" class="text-center border_right_td"><input class="static_width_td" type="text" placeholder="0.00" name="deposit" id="deposit1" readonly required/></td>
                                                        <td width="9%" class="text-center border_right_td">
                                                            <a class="m-l-10 plus_hover add_button" href="javascript:;"><i class="fa fa-plus" aria-hidden="true"></i></a>
                                                            <a class="m-l-10" href="javascript:;"><i class="fa fa-trash-o red_color" aria-hidden="true"></i></a>
                                                        </td>

                                                    </tr>



                                                </tbody>

                                                <tbody class="field_wrapper"></tbody>

                                            </table>

                                            <input hidden type="text" name="rowCounterrr" id="rowCounter" value="1" />





                                        </div>
                                    </div>


                                    <div class="row p-t-10">
                                        <div class="table-responsive p-t-10">
                                            <table id="myTable" class="table firstrow">
                                                <thead>
                                                    <tr class="bg-dark">
                                                        <th class="text-center border_right_td">Total Freight</th>
                                                        <th class="text-center border_right_td">Credit Card Fee</th>
                                                        <th class="text-center border_right_td">Total Tax</th>
                                                        <th class="text-center border_right_td">Total Units</th>
                                                        <th class="text-center">Total Deposit</th>

                                                    </tr>
                                                </thead>
                                                <tbody>

                                                    <tr>
                                                        <td class="text-center border_right_td"><input class="static_width_td" type="text" placeholder="0.00" value="0.00" name="total_freight" onkeypress="validation_numeric(event)" required/></td>
                                                        <td class="text-center border_right_td"><input class="static_width_td" type="text" placeholder="0.00" value="0.00" name="credit_card_fee" onkeypress="validation_numeric(event)" required/></td>
                                                        <td class="text-center border_right_td"><input class="static_width_td" type="text" placeholder="0.00" value="0.00" name="total_tax" onkeypress="validation_numeric(event)" required/></td>
                                                        <td class="text-center border_right_td"><input class="static_width_td" type="text" placeholder="0.00" name="total_units" id="total_units" readonly required/></td>
                                                        <td class="text-center border_right_td"><input class="static_width_td" type="text" placeholder="0.00" name="total_deposit" id="total_deposit" readonly required/></td>

                                                    </tr>



                                                </tbody>
                                            </table>


                                        </div>
                                    </div>



                                    <div class="form-actions  m-t-40">
                                        <div class="row">
                                            <div class="col-md-12">
                                                <div class="row">
                                                    @*<div class="col-md-4"></div>*@
                                                    <div class="col-md-4">
                                                        <button type="submit" class="btn btn-info"> <i class="fa fa-check"></i> Submit</button>
                                                        <button type="button" class="btn btn-danger">Cancel</button>
                                                    </div>
                                                    @*<div class="col-md-4"></div>*@
                                                </div>
                                            </div>
                                        </div>
                                    </div>


                                </div>
                            </form>
                        </div>
                    </div>

                    <div class="clear"></div>

                    <div style="margin-bottom:200px">
                    </div>
                    <div class="clear"></div>

                </div>



            </div>

        </div>

    </div>

    @{
        Html.RenderPartial("Footer");
    }

</body>


@*------------------------PRESENT DATE---------------------*@
<script>

    function SetDate() {
        jQuery('#invoice_date_create').datepicker({
            format: 'dd-M-yyyy',
            autoclose: true,
            todayHighlight: true,

        });


        var date = new Date();

        var day = date.getDate();
        var month = date.getMonth() + 1;
        var year = date.getFullYear();

        if (month == 1) {
            month = "Jan";
        }
        else if (month == 2) {
            month = "Feb";
        }
        else if (month == 3) {
            month = "Mar";
        }
        else if (month == 4) {
            month = "Apr";
        }
        else if (month == 5) {
            month = "May";
        }
        else if (month == 6) {
            month = "Jun";
        }
        else if (month == 7) {
            month = "Jul";
        }
        else if (month == 8) {
            month = "Aug";
        }
        else if (month == 9) {
            month = "Sep";
        }
        else if (month == 10) {
            month = "Oct";
        }
        else if (month == 11) {
            month = "Nov";
        }
        else if (month == 12) {
            month = "Dec";
        }
        if (day < 10) day = "0" + day;

        var today = day + "-" + month + "-" + year;



        document.getElementById('invoice_date_create').value = today;

        jQuery('#est_ship_date').datepicker({
            format: 'dd-M-yyyy',
            autoclose: true,
            todayHighlight: true,

        });

    }

</script>

@*------------------------PRESENT DATE---------------------*@


@*------------------------CALCULATION OF PRICES PRODUCTS---------------------*@

<script>
    function Total(id) {
        var footage = $("#footage" + id).val();

        var mbf = footage / 1000;
        var price = $("#price" + id).val();

        var deposit = (price * mbf).toFixed(2);

        $("#deposit" + id).val(deposit);

        var row_count = $("#rowCounter").val();

        var check = 0;
        var total_price = 0;
        var a_price = 0;

        for (i = 1; i <= row_count ; ++i) {

            check = document.getElementById('deposit' + i);

            if (check === null) {

            }
            else {
                if (check !== null) {

                    total_price = document.getElementById('deposit' + i).value;

                    a_price = (+total_price + +a_price).toFixed(2);
                }
                else {

                    row_count = +row_count + +1;
                }
            }
        }


        $("#total_deposit").val(a_price);

        var check2 = 0;
        var total_footage = 0;
        var a_footage = 0;

        for (i = 1; i <= row_count ; ++i) {

            check2 = document.getElementById('footage' + i);
            if (check2 === null) {

            }
            else {
                if (check2 !== null) {

                    total_footage = document.getElementById('footage' + i).value;

                    a_footage = +total_footage + +a_footage;
                }
                else {

                    row_count = +row_count + +1;
                }
            }
        }
        $("#total_units").val(a_footage.toFixed(2));

    }
</script>

@*------------------------CALCULATION OF PRICES PRODUCTS---------------------*@





<script>

    @*------------------------MORE FIELDS PRODUCTS---------------------*@

    var addButton = $('.add_button');
    var wrapper = $('.field_wrapper');
    var counter = 2;
    $(addButton).click(function () {
        //alert("asasas");
        var fieldHTML = '<tr class="r"><td class="text-center border_right_td"><textarea class="static_width_td" placeholder="Description" name="description" id="description' + counter + '"></textarea></td><td width="12%" class="text-center border_right_td"><input class="static_width_td" type="text" placeholder="0.00" name="quantity" id="quantity' + counter + '" onkeypress="validation_numeric(event)"/></td><td width="12%" class="text-center border_right_td"><input class="static_width_td" type="text" placeholder="0.00" name="footage" id="footage' + counter + '" onkeyup="Total(' + counter + ')" onkeypress="validation_numeric(event)" /></td><td width="12%" class="text-center border_right_td"><input class="static_width_td" type="text" placeholder="0.00" name="price" id="price' + counter + '" onkeyup="Total(' + counter + ')" onkeypress="validation_numeric(event)" /></td><td width="12%" class="text-center border_right_td"><input class="static_width_td" type="text" placeholder="0.00" name="deposit" id="deposit' + counter + '" readonly/></td><td width="9%" class="text-center border_right_td"><a class="m-l-10 plus_hover add_button" href="javascript:;"><i class="fa fa-plus" aria-hidden="true"></i></a><a href="javascript:;" class="m-l-10 remove_button" id="' + counter + '" href="#"><i class="fa fa-trash-o red_color" aria-hidden="true"></i></a></td></tr>'
        $(wrapper).append(fieldHTML);

        counter = +counter + +1;

        var row_count = $("#rowCounter").val();
        row_count = +row_count + +1;
        $("#rowCounter").val(row_count);
    });


    @*------------------------MORE FIELDS PRODUCTS---------------------*@

    @*------------------------REMOVE TR PRODUCTS---------------------*@

    $(wrapper).on('click', '.remove_button', function (e) {

        var deleted_row_id = $(this).attr("id");

        var row_count = $("#rowCounter").val();

        Total_Remove(row_count, deleted_row_id)

        $("#rowCounter").val(row_count);
        e.preventDefault();
        $(this).closest('.r').remove();
    });


    @*------------------------REMOVE TR PRODUCTS---------------------*@

    @*------------------------CALCULATE PRICES ON REMOVE ---------------------*@

    function Total_Remove(id, deleted_row_id) {
        
        var row_count = $("#rowCounter").val();

        row_count = row_count - 1;
        $("#rowCounter").val(row_count);

        if (id === null) {

        }
        else {

            var footage = $("#footage" + id).val();

            var mbf = footage / 1000;
            var price = $("#price" + id).val();

            var deposit = (price * mbf).toFixed(2);

            $("#deposit" + id).val(deposit);

            var check = 0;
            var total_price = 0;
            var a_price = 0;
        }


        for (i = 1; i <= row_count + 1 ; i++) {

            if (i == deleted_row_id) {
                continue;
            }

            check = document.getElementById('deposit' + i);

            if (check === null) {

            }
            else {
                if (check !== null) {

                    total_price = document.getElementById('deposit' + i).value;

                    a_price = (+total_price + +a_price).toFixed(2);
                }
                else {

                    row_count = +row_count + +1;
                }
            }

        }

        //alert("For 1 " + row_count);

        $("#total_deposit").val(a_price);

        var check2 = 0;
        var total_footage = 0;
        var a_footage = 0;
        
        for (i = 1; i <= row_count + 1 ; i++) {

            //alert("For 2 " + id);

            if (i == deleted_row_id) {
                continue;
            }

            check2 = document.getElementById('footage' + i);
            if (check2 === null) {

            }
            else {
                if (check2 !== null) {

                    total_footage = document.getElementById('footage' + i).value;

                    a_footage = +total_footage + +a_footage;
                }
                else {

                    row_count = +row_count + +1;
                }
            }
        }
        
        $("#total_units").val(a_footage.toFixed(2));

    }


    @*------------------------CALCULATE PRICES ON REMOVE ---------------------*@

</script>